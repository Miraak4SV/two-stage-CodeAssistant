# Two-Stage Code Assistant

**Интеллектуальный помощник** с двухэтапной обработкой запросов на основе языковых моделей.

---

## Концепция

Проект демонстрирует **двухэтапный подход** к созданию интеллектуального помощника:

1. **Поиск**

   * **Семантический поиск** с использованием векторных эмбеддингов (SentenceTransformers)
   * **Grep-режим** для быстрого точечного поиска по ключевым словам
2. **Генерация**

   * Динамическая сборка промпта: выбранный фрагмент «базы знаний» + исходный запрос
   * Генерация развёрнутого ответа с помощью **YandexGPT**

Этот подход сочетает **точность поиска** и **гибкость** современных LLM.

---

## Состав репозитория

* **code\_to\_json.py** — скрипт для автоматического сбора фрагментов кода из Python-проектов (AST-анализ) и генерации базы знаний в формате JSONL.
* **sklearn\_knowledge\_base.jsonl** — пример сгенерированной базы знаний из Scikit-learn.
* **app.py** — Streamlit-приложение для ввода запросов, выбора режима поиска и получения ответа от YandexGPT.
* **embeddings.pt** — кэш эмбеддингов для ускорения многократных запросов.
* **requirements.txt** — список необходимых Python-библиотек.

---

## Установка и запуск

1. **Клонировать репозиторий**

   ```bash
   git clone https://github.com/ваш-профиль/two-stage-code-assistant.git
   cd two-stage-code-assistant
   ```

2. **Установить зависимости**

   ```bash
   pip install -r requirements.txt
   ```

3. **Запустить приложение**

   ```bash
   streamlit run app.py
   ```

4. **Ввести ваш YandexGPT API-ключ** при запросе и начать работу.

---

## Основные возможности

* **Автоматическая генерация базы знаний** из любого Python-кода с извлечением функций и классов.
* **Два режима поиска**:

  * **Semantic** — поиск по смыслу через косинусное сходство эмбеддингов.
  * **Grep** — поиск по ключевым словам с точечным подсчётом совпадений.
* **Ограничение длины промпта** для стабильной работы LLM.
* **Кэширование эмбеддингов** (`embeddings.pt`) для мгновенного отклика при повторных запусках.
* **Интеграция с YandexGPT** для генерации подробных ответов на основе найденных фрагментов.

---

## Настройка базы знаний

Чтобы создать свою базу знаний из произвольного Python-проекта:

1. **Укажите путь** в `code_to_json.py` (переменная `CODE_DIR`).
2. **Запустите**:

   ```bash
   python code_to_json.py > your_knowledge_base.jsonl
   ```
3. **Переименуйте** или скопируйте файл `your_knowledge_base.jsonl` в корень проекта и обновите `BASE_FILE` в `app.py`.

---

*Данный репозиторий подготовлен в рамках дипломного проекта по теме "Интеллектуальный помощник с двухэтапной обработкой запросов на основе языковых моделей".*
